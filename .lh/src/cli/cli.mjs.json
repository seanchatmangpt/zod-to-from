{
    "sourceFile": "src/cli/cli.mjs",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1758644495329,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1758644495329,
            "name": "Commit-0",
            "content": "#!/usr/bin/env node\n\n/**\n * ZTF CLI - Command-line interface for zod-to-from\n * Structured around nouns (things you operate on) and verbs (actions you take)\n *\n * Core Philosophy:\n * - Nouns: artifact, schema, adapter, audit, test\n * - Verbs: convert, parse, format, validate, migrate, list, export, run\n */\n\n// Import command implementations\nimport * as adapterCommands from './commands/adapter.mjs';\nimport * as artifactCommands from './commands/artifact.mjs';\nimport * as auditCommands from './commands/audit.mjs';\nimport * as schemaCommands from './commands/schema.mjs';\nimport * as testCommands from './commands/test.mjs';\n\n// Import adapters to register them\nimport '../adapters/data.mjs';\n\n/**\n * CLI configuration and options\n * @typedef {Object} CLIOptions\n * @property {string} schema - Path to schema file with export\n * @property {string} from - Source format\n * @property {string} to - Target format\n * @property {string} in - Input file path\n * @property {string} out - Output file path\n * @property {boolean} repair - Enable auto-fix and re-validation\n * @property {string} llmPrompt - Prompt for LLM-assisted adapters\n * @property {boolean} provenance - Include provenance metadata\n * @property {boolean} deterministic - Enforce deterministic output\n * @property {boolean} streaming - Use streaming for large datasets\n * @property {string} format - Output format for audit export\n * @property {string} type - Test type (round-trip, fuzz, etc.)\n * @property {string} name - Adapter name for info command\n */\n\n/**\n * Parse command-line arguments\n * @param {string[]} args - Command line arguments\n * @returns {Object} Parsed command and options\n */\nfunction parseArgs(args) {\n  const noun = args[0];\n  const verb = args[1];\n  const command = `${noun} ${verb}`;\n  const options = {};\n\n  for (let i = 2; i < args.length; i += 2) {\n    const key = args[i]?.replace('--', '');\n    const value = args[i + 1];\n\n    if (key && value) {\n      // Convert boolean flags\n      if (value === 'true') {\n        options[key] = true;\n      } else if (value === 'false') {\n        options[key] = false;\n      } else {\n        options[key] = value;\n      }\n    }\n  }\n\n  return { command, options };\n}\n\n/**\n * Show help information\n */\nfunction showHelp() {\n  console.log(`\nZTF CLI - Universal I/O conversion layer for Zod schemas\n\nUSAGE:\n  ztf <noun> <verb> [options]\n\nNOUNS:\n  artifact    Operate on data artifacts (convert, parse, format)\n  schema      Manage schemas (migrate, validate)\n  adapter     Manage adapters (list, info)\n  audit       Manage audit logs (export, show)\n  test        Run tests (run, validate)\n\nVERBS:\n  convert     Convert between formats (artifact)\n  parse       Parse and validate input (artifact)\n  format      Format validated data (artifact)\n  migrate     Migrate schema versions (schema)\n  list        List available adapters (adapter)\n  export      Export audit logs (audit)\n  run         Run tests (test)\n\nEXAMPLES:\n  # Convert CSV to Parquet\n  ztf artifact convert --from csv --to parquet --schema ./schemas/data.mjs#DataSchema --in data.csv --out data.parquet\n\n  # Parse TOML config\n  ztf artifact parse --from toml --schema ./schemas/config.mjs#Config --in config.toml\n\n  # Format JSON to Turtle\n  ztf artifact format --to ttl --schema ./schemas/user.mjs#UserSchema --in user.json --out user.ttl\n\n  # List available adapters\n  ztf adapter list\n\n  # Export audit log\n  ztf audit export --format turtle --in provenance.json --out audit.ttl\n\n  # Run round-trip test\n  ztf test run --type round-trip --schema ./schemas/data.mjs#DataSchema --format yaml --in data.yaml\n\nOPTIONS:\n  --schema <path>     Path to schema file (required for artifact operations)\n  --from <format>     Source format\n  --to <format>       Target format\n  --in <file>         Input file path (defaults to stdin)\n  --out <file>        Output file path (defaults to stdout)\n  --repair            Enable auto-fix and re-validation\n  --llm-prompt <text> Prompt for LLM-assisted adapters\n  --provenance        Include provenance metadata\n  --deterministic     Enforce deterministic output\n  --streaming         Use streaming for large datasets\n  --format <format>   Output format for audit export\n  --type <name>       Test type (round-trip, fuzz, etc.)\n\nFor more information, visit: https://github.com/unjs/zod-to-from\n`);\n}\n\n/**\n * Main CLI function\n */\nasync function main() {\n  const args = process.argv.slice(2);\n\n  if (args.length === 0 || args[0] === 'help' || args.includes('--help')) {\n    showHelp();\n    return;\n  }\n\n  const { command, options } = parseArgs(args);\n\n  // Validate required options based on command\n  if (\n    ['artifact convert', 'artifact parse', 'artifact format'].includes(command) &&\n    !options.schema\n  ) {\n    console.error('❌ Error: --schema is required for artifact operations');\n    process.exit(1);\n  }\n\n  // Execute command\n  switch (command) {\n    case 'artifact convert': {\n      await artifactCommands.convert(options);\n      break;\n    }\n    case 'artifact parse': {\n      await artifactCommands.parse(options);\n      break;\n    }\n    case 'artifact format': {\n      await artifactCommands.format(options);\n      break;\n    }\n    case 'adapter list': {\n      await adapterCommands.list(options);\n      break;\n    }\n    case 'adapter info': {\n      await adapterCommands.info(options);\n      break;\n    }\n    case 'schema migrate': {\n      await schemaCommands.migrate(options);\n      break;\n    }\n    case 'schema validate': {\n      await schemaCommands.validate(options);\n      break;\n    }\n    case 'audit export': {\n      await auditCommands.exportAudit(options);\n      break;\n    }\n    case 'audit show': {\n      await auditCommands.show(options);\n      break;\n    }\n    case 'test run': {\n      await testCommands.run(options);\n      break;\n    }\n    default: {\n      console.error(`❌ Unknown command: ${command}`);\n      console.error('Run \"ztf help\" for usage information');\n      process.exit(1);\n    }\n  }\n}\n\n// Execute if this is the main module\nif (import.meta.url === `file://${process.argv[1]}`) {\n  await main();\n}\n"
        }
    ]
}