{
    "sourceFile": "src/cli/commands/audit.mjs",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1758644495340,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1758644495340,
            "name": "Commit-0",
            "content": "/**\n * Audit command implementations\n * @fileoverview Commands for managing audit logs and provenance\n */\n\nimport { readFile, writeFile } from 'node:fs/promises';\n\n/**\n * Export command - Export audit logs to specified format\n * @param {Object} options - Command options\n */\nexport async function exportAudit(options) {\n  const { format: outputFormat, in: inputPath, out: outputPath } = options;\n\n  try {\n    // Read input provenance data\n    const input = await readFile(inputPath, 'utf8');\n    const provenanceData = JSON.parse(input);\n\n    // Convert to requested format\n    let output;\n    switch (outputFormat) {\n      case 'turtle':\n      case 'ttl': {\n        output = convertToTurtle(provenanceData);\n        break;\n      }\n      case 'json': {\n        output = JSON.stringify(provenanceData, undefined, 2);\n        break;\n      }\n      case 'jsonl': {\n        output = JSON.stringify(provenanceData);\n        break;\n      }\n      default: {\n        throw new Error(`Unsupported export format: ${outputFormat}`);\n      }\n    }\n\n    // Write output\n    await writeFile(outputPath, output, 'utf8');\n\n    console.log(`âœ… Successfully exported audit log to ${outputPath} (${outputFormat})`);\n  } catch (error) {\n    console.error(`âŒ Export failed: ${error.message}`);\n    throw error;\n  }\n}\n\n/**\n * Show command - Display audit information\n * @param {Object} options - Command options\n */\nexport async function show(options) {\n  const { in: inputPath, format: displayFormat } = options;\n\n  try {\n    // Read input provenance data\n    const input = await readFile(inputPath, 'utf8');\n    const provenanceData = JSON.parse(input);\n\n    // Display in requested format\n    switch (displayFormat) {\n      case 'table': {\n        displayAsTable(provenanceData);\n        break;\n      }\n      case 'json': {\n        console.log(JSON.stringify(provenanceData, undefined, 2));\n        break;\n      }\n      default: {\n        displayAsSummary(provenanceData);\n      }\n    }\n  } catch (error) {\n    console.error(`âŒ Show failed: ${error.message}`);\n    throw error;\n  }\n}\n\n/**\n * Convert provenance data to Turtle format\n * @param {Object} data - Provenance data\n * @returns {string} Turtle representation\n */\nfunction convertToTurtle(data) {\n  const timestamp = data.timestamp || new Date().toISOString();\n  const adapter = data.adapter || 'unknown';\n  const sourceFormat = data.sourceFormat || 'unknown';\n  const targetFormat = data.targetFormat || 'unknown';\n\n  return `@prefix prov: <http://www.w3.org/ns/prov#> .\n@prefix ztf: <https://github.com/unjs/zod-to-from/prov#> .\n\n<#operation> a prov:Activity ;\n    prov:startedAtTime \"${timestamp}\"^^xsd:dateTime ;\n    ztf:adapter \"${adapter}\" ;\n    ztf:sourceFormat \"${sourceFormat}\" ;\n    ztf:targetFormat \"${targetFormat}\" ;\n    ztf:version \"${data.version || 'unknown'}\" .\n`;\n}\n\n/**\n * Display provenance data as a table\n * @param {Object} data - Provenance data\n */\nfunction displayAsTable(data) {\n  console.log('ğŸ“‹ Audit Information:');\n  console.log('â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”');\n  console.log(`â”‚ Timestamp       â”‚ ${data.timestamp || 'unknown'} â”‚`);\n  console.log(`â”‚ Adapter         â”‚ ${data.adapter || 'unknown'} â”‚`);\n  console.log(`â”‚ Source Format   â”‚ ${data.sourceFormat || 'unknown'} â”‚`);\n  console.log(`â”‚ Target Format   â”‚ ${data.targetFormat || 'unknown'} â”‚`);\n  console.log(`â”‚ Version         â”‚ ${data.version || 'unknown'} â”‚`);\n  if (data.aiModel) {\n    console.log(`â”‚ AI Model        â”‚ ${data.aiModel} â”‚`);\n  }\n  if (data.schemaHash) {\n    console.log(`â”‚ Schema Hash     â”‚ ${data.schemaHash} â”‚`);\n  }\n  console.log('â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜');\n}\n\n/**\n * Display provenance data as a summary\n * @param {Object} data - Provenance data\n */\nfunction displayAsSummary(data) {\n  console.log('ğŸ“‹ Audit Summary:');\n  console.log(`  Timestamp: ${data.timestamp || 'unknown'}`);\n  console.log(`  Adapter: ${data.adapter || 'unknown'}`);\n  console.log(`  Source: ${data.sourceFormat || 'unknown'}`);\n  console.log(`  Target: ${data.targetFormat || 'unknown'}`);\n  console.log(`  Version: ${data.version || 'unknown'}`);\n  if (data.aiModel) {\n    console.log(`  AI Model: ${data.aiModel}`);\n  }\n  if (data.schemaHash) {\n    console.log(`  Schema Hash: ${data.schemaHash}`);\n  }\n}\n"
        }
    ]
}